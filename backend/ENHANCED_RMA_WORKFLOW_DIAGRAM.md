# ğŸ“Š Enhanced RMA Workflow - Visual Diagram

## ğŸ”„ Complete Workflow with Branching Paths

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PHASE 1: INITIAL SUBMISSION                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. OPEN
   â”‚
   â”‚ [Submit RMA Form]
   â†“
2. RMA_FORM_SUBMITTED
   â”‚
   â”‚ [Manager/Admin Reviews]
   â†“
3. RMA_APPROVED
   â”‚
   â”‚ [Order Replacement Part]
   â†“
4. RMA_RAISED_YET_TO_DELIVER
   â”‚
   â”‚ [Replacement Part Ordered]
   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚              DECISION POINT: Delivery Path                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                           â”‚
   â”‚ PATH A: Part Comes to Ascomp First                          â”‚
   â”‚                                                           â”‚
   â†“                                                           â”‚
5. REPLACEMENT_PART_RECEIVED_AT_CDS                           â”‚
   â”‚                                                           â”‚
   â”‚ [Inspect & Verify]                                       â”‚
   â†“                                                           â”‚
6. REPLACEMENT_PART_SHIPPED_TO_SITE                          â”‚
   â”‚                                                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                           â”‚
   â”‚ PATH B: Direct Shipment to Site                          â”‚
   â”‚                                                           â”‚
   â†“                                                           â”‚
6. REPLACEMENT_PART_SHIPPED_DIRECTLY_TO_SITE                 â”‚
   â”‚                                                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”‚ [Both paths converge here]
   â†“
7. REPLACEMENT_PART_INSTALLED_AT_SITE
   â”‚
   â”‚ [Site Technician Confirms]
   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚              PHASE 2: DEFECTIVE PART COLLECTION             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â†“
8. DEFECTIVE_PART_PACKAGING_IN_PROGRESS
   â”‚
   â”‚ [Package Part]
   â”‚ [Upload Video if Required]
   â”‚ [Take Photos]
   â”‚ [Complete Checklist]
   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚         DECISION POINT: Defective Part Return Path        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                           â”‚
   â”‚ PATH A: Direct Shipment to CDS                           â”‚
   â”‚                                                           â”‚
   â†“                                                           â”‚
9. DEFECTIVE_PART_SHIPPED_TO_CDS                              â”‚
   â”‚                                                           â”‚
   â”‚ [Track Shipment]                                         â”‚
   â†“                                                           â”‚
10. DEFECTIVE_PART_RECEIVED_AT_CDS                           â”‚
   â”‚                                                           â”‚
   â”‚ [Inspect Packaging]                                      â”‚
   â”‚                                                           â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                                                           â”‚
   â”‚ If Repackaging Needed:                                   â”‚
   â†“                                                           â”‚
11. DEFECTIVE_PART_REPACKAGED_AT_CDS                         â”‚
   â”‚                                                           â”‚
   â”‚ [Create New Packaging Video]                             â”‚
   â”‚ [Update Documentation]                                    â”‚
   â”‚                                                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”‚ [Both paths converge here]
   â†“
12. DEFECTIVE_PART_SHIPPED_TO_OEM
   â”‚
   â”‚ [Track to OEM]
   â”‚ [Record OEM Case Number]
   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚              PHASE 3: OEM RESPONSE & CLOSURE                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â†“
13. OEM_RESPONSE_PENDING
   â”‚
   â”‚ [Wait for OEM Response]
   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                      â”‚                      â”‚
   â†“                      â†“                      â†“
14. OEM_CREDIT_RECEIVED  14. OEM_REJECTED       [Timeout]
   â”‚                      â”‚                      â”‚
   â”‚                      â”‚                      â”‚
   â†“                      â†“                      â†“
15. CLOSED               15. CLOSED             15. CLOSED
   â”‚                      â”‚                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Decision Points

### **Decision Point 1: Replacement Part Delivery**

**Question**: Does the replacement part come to CDS first, or ship directly to site?

**If Part Comes to CDS First:**
```
rma_raised_yet_to_deliver
  â†’ replacement_part_received_at_cds
  â†’ replacement_part_shipped_to_site
  â†’ replacement_part_installed_at_site
```

**If Direct Shipment to Site:**
```
rma_raised_yet_to_deliver
  â†’ replacement_part_shipped_directly_to_site
  â†’ replacement_part_installed_at_site
```

**Field**: `isDirectShipmentToSite` (Boolean)

---

### **Decision Point 2: Defective Part Return Path**

**Question**: Does the defective part go directly to CDS, or does it need repackaging at CDS?

**If Direct Shipment to CDS:**
```
defective_part_packaging_in_progress
  â†’ defective_part_shipped_to_cds
  â†’ defective_part_received_at_cds
  â†’ defective_part_shipped_to_oem
```

**If Repackaging Needed at CDS:**
```
defective_part_packaging_in_progress
  â†’ defective_part_received_at_cds
  â†’ defective_part_repackaged_at_cds
  â†’ defective_part_shipped_to_oem
```

**Field**: `defectivePartReturnPath` (Enum: `direct_to_cds` | `via_cds_repackaging`)

---

### **Decision Point 3: Packaging Video Requirement**

**Question**: Does this part type require a packaging video?

**If Video Required:**
- Must upload `packagingVideoUrl` before moving to next status
- System enforces validation

**If Video Not Required:**
- Video optional
- Can proceed without video

**Field**: `requiresPackagingVideo` (Boolean)
**Source**: Part type configuration or RMA type configuration

---

## ğŸ“‹ Status Summary Table

| Phase | Status | Description | Required Fields |
|-------|--------|-------------|----------------|
| **1** | `open` | Case open, observation ongoing | - |
| **1** | `rma_form_submitted` | Form submitted, awaiting approval | All form fields |
| **1** | `rma_approved` | Approved by manager/admin | `rmaApprovedBy`, `rmaApprovedDate` |
| **1** | `rma_raised_yet_to_deliver` | Replacement part ordered | `replacementPartOrderDate` |
| **2** | `replacement_part_received_at_cds` | Part received at CDS | `replacementPartReceivedAtCdsDate`, `replacementPartReceivedBy` |
| **2** | `replacement_part_shipped_to_site` | Shipped from CDS to site | `replacementPartCarrier`, `replacementPartTrackingNumber` |
| **2** | `replacement_part_shipped_directly_to_site` | Direct shipment to site | `replacementPartCarrier`, `replacementPartTrackingNumber` |
| **2** | `replacement_part_installed_at_site` | Installed at site | `replacementPartInstalledDate`, `replacementPartInstalledBy` |
| **3** | `defective_part_packaging_in_progress` | Packaging defective part | `defectivePartPackagingDate`, `defectivePartPackagedBy` |
| **4** | `defective_part_shipped_to_cds` | Shipped from site to CDS | `returnTrackingNumber`, `returnShippedDate` |
| **4** | `defective_part_received_at_cds` | Received at CDS | `defectivePartReceivedAtCdsDate`, `defectivePartReceivedBy` |
| **4** | `defective_part_repackaged_at_cds` | Repackaged at CDS | `defectivePartRepackagedAtCdsDate`, `defectivePartRepackagedBy` |
| **4** | `defective_part_shipped_to_oem` | Shipped to OEM | `defectivePartOemCaseNumber`, `defectivePartOemTrackingNumber` |
| **5** | `oem_response_pending` | Waiting for OEM response | - |
| **5** | `oem_credit_received` | OEM credit received | `oemCreditReceivedDate`, `oemCreditAmount` |
| **5** | `oem_rejected` | OEM rejected RMA | `oemRejectedDate`, `oemRejectionReason` |
| **5** | `closed` | RMA completed | - |
| **5** | `cancelled` | RMA cancelled | - |

---

## ğŸ”€ Workflow Paths Visualization

### **Complete Path A: Standard Flow (Part to CDS First)**
```
open
  â†’ rma_form_submitted
  â†’ rma_approved
  â†’ rma_raised_yet_to_deliver
  â†’ replacement_part_received_at_cds
  â†’ replacement_part_shipped_to_site
  â†’ replacement_part_installed_at_site
  â†’ defective_part_packaging_in_progress
  â†’ defective_part_shipped_to_cds
  â†’ defective_part_received_at_cds
  â†’ defective_part_shipped_to_oem
  â†’ oem_response_pending
  â†’ oem_credit_received
  â†’ closed
```

### **Complete Path B: Direct Shipment Flow**
```
open
  â†’ rma_form_submitted
  â†’ rma_approved
  â†’ rma_raised_yet_to_deliver
  â†’ replacement_part_shipped_directly_to_site
  â†’ replacement_part_installed_at_site
  â†’ defective_part_packaging_in_progress
  â†’ defective_part_shipped_to_cds
  â†’ defective_part_received_at_cds
  â†’ defective_part_shipped_to_oem
  â†’ oem_response_pending
  â†’ oem_credit_received
  â†’ closed
```

### **Complete Path C: With Repackaging**
```
open
  â†’ rma_form_submitted
  â†’ rma_approved
  â†’ rma_raised_yet_to_deliver
  â†’ replacement_part_received_at_cds
  â†’ replacement_part_shipped_to_site
  â†’ replacement_part_installed_at_site
  â†’ defective_part_packaging_in_progress
  â†’ defective_part_received_at_cds
  â†’ defective_part_repackaged_at_cds
  â†’ defective_part_shipped_to_oem
  â†’ oem_response_pending
  â†’ oem_credit_received
  â†’ closed
```

---

## âš ï¸ Validation Rules

### **Status Transition Validation**

1. **Cannot skip statuses** - Must follow valid transitions
2. **Required fields must be filled** - Before moving to next status
3. **Video required if part type requires it** - Cannot proceed without video
4. **Approval required** - Only managers/admins can approve
5. **Installation confirmation** - Site must confirm installation

### **Field Validation**

- **Dates**: Must be valid dates, cannot be in future (except for scheduled dates)
- **Tracking Numbers**: Must be unique per shipment
- **Video URLs**: Must be valid URLs, accessible
- **Photos**: Must be valid image files
- **Amounts**: Must be positive numbers

---

## ğŸ“Š Status Color Coding

| Status | Color | Meaning |
|--------|-------|---------|
| `open` | ğŸ”µ Blue | Initial state |
| `rma_form_submitted` | ğŸŸ¡ Yellow | Awaiting action |
| `rma_approved` | ğŸŸ¢ Green | Approved |
| `rma_raised_yet_to_deliver` | ğŸŸ¡ Yellow | In progress |
| `replacement_part_*` | ğŸŸ¡ Yellow | Replacement in progress |
| `replacement_part_installed_at_site` | ğŸŸ¢ Green | Completed step |
| `defective_part_packaging_in_progress` | ğŸŸ  Orange | Packaging required |
| `defective_part_repackaged_at_cds` | ğŸŸ  Orange | Repackaging |
| `defective_part_shipped_to_oem` | ğŸŸ£ Purple | With OEM |
| `oem_response_pending` | ğŸŸ£ Purple | Waiting for OEM |
| `oem_credit_received` | ğŸŸ¢ Green | Success |
| `oem_rejected` | ğŸ”´ Red | Rejected |
| `closed` | âš« Gray | Completed |
| `cancelled` | ğŸ”´ Red | Cancelled |

---

## ğŸ”” Notification Flow

```
Status Change â†’ Check Notification Rules â†’ Send Notifications
```

**Notification Types:**
- ğŸ“§ Email
- ğŸ”” In-app notification
- ğŸ“± SMS (for critical statuses)
- ğŸ’¬ Slack/Teams (optional)

**Recipients:**
- Assigned engineer
- Case creator
- Manager/Admin
- Site contact (for installation status)
- Finance team (for OEM credit)





